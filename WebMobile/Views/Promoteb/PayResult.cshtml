@model WebMobile.Models.Promote.PayResultViewModel
@{
    ViewBag.Title = "恭喜您，抢购成功";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section styles{
    <style type="text/css">
        .popd {
            /*display: none;*/
            width: 100%;
            height: 100%;
            left: 0;
            top: 0;
            position: fixed;
            background: rgba(0,0,0,0.3);
            z-index: 100;
        }

        .popd-outer {
            position: absolute;
            left: 50%;
            top: 50%;
        }

        .popd-inter {
            width: 300px;
            height: 340px;
            position: absolute;
            left: -150px;
            top: -170px;
            border: 2px solid #fff;
            background: #fff;
            border-radius: 10px 9px 5px 8px;
        }

        .list-input-item .item-name {
            width: 140px;
            padding-right: 5px;
            color: #fb6088;
        }

        .radio {
            width: 23px;
            height: 23px;
            border-radius: 50%;
            position: relative;
            -webkit-appearance: none;
            -webkit-tap-highlight-color: rgba(255,0,0,0);
            outline: none;
            border: none;
            background-repeat: repeat;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .radio::after {
            content: '';
            width: 23px;
            height: 23px;
            -webkit-appearance: none;
            position: absolute;
            top: 0;
            left: 0;
            border: 1px solid gray;
            border-radius: 50%;
            padding: 0.4rem;
            background-clip: content-box;
            box-sizing: border-box;
        }

        .radio:checked::after {
            outline: none;
            background-color: #dc3729;
            border: 1px solid #dc3729;
            background-clip: content-box;
            -webkit-appearance: none;
            background-repeat: repeat;
            -webkit-background-clip: content-box;
            -webkit-text-fill-color: #dc3729;
        }
    </style>

}

<div class="gbr gbr-main">
    <div>
        <img src="~/Content/images/promote20181021/bg_suc_01.jpg" />
    </div>
    <div style="position: relative;">
        <img src="~/Content/images/promote20181021/bg_suc_02.jpg" />




        <div style="position: absolute;width: 100%;height: 100%;top: 0;align-items: center;justify-content: center; display: flex;">
            @if (Model.PromoteIsEnd)
            {
                <div style="width:100%;top:0px;text-align: center;font-size:24px;color:#f53300;">
                    <p>该活动已经结束，谢谢关注！</p>
                </div>
            }
            else
            {
                <div style="width:50%;float:left;text-align: right;">
                    <img id="btn_OpenCoupon" src="~/Content/images/promote20181021/btn_opencoupon.png" class="btn-com" style="margin-right:15px;display: inline-block;" />
                </div>
                <div style="width:50%;float:left;text-align:left;">
                    <img id="btn_GoInvite" src="~/Content/images/promote20181021/btn_invite.png" class="btn-com" style="margin-left:15px;display: inline-block;" />
                </div>
            }
        </div>



    </div>
    <div>
        <img src="~/Content/images/promote20181021/bg_suc_03.jpg" />
    </div>
    <div style="position: relative;">
        <img src="~/Content/images/promote20181021/bg_suc_04.jpg" />
        <div style="position: absolute;width: 100%;height: 100%;top: 0;align-items: center;justify-content: flex-end ;right: 5%;  display: flex;">

            <a href="/Personal/Index">
                <img class="btn-com" id="btn_GoPersonal" src="~/Content/images/promote20181021/btn_personal.png" />
            </a>

        </div>
    </div>
</div>

<div class="popd" style="display:none">
    <div class="popd-outer">

        <div class="popd-inter">
            <div class="popd-close" style="position: absolute; right: -6px;top:-16px;"> <img src="~/Content/images/promote20180910/popd_close.png" style="width:32px;height:32px;" /></div>
            <div>
                <p style="color:#fb6088;text-align:center;font-size:18px;font-weight:bold; line-height:24px;margin-top:20px;">领取卡券</p>
                <p style="color:#fb6088;text-align:center;font-size:18px;font-weight:bold; line-height:24px;">请先填写以下信息</p>

                <div style="margin-top:20px;margin-bottom:20px;">

                    <ul class="list-input" style="overflow:hidden">
                        <li class="list-input-item">
                            <div class="item-left fl">
                                <div class="item-name  fl"><span>姓名</span></div>
                                <div class="item-value fr">

                                    <input id="txt_ctName" placeholder="请输入姓名" type="text" style="width:100%;" />

                                </div>
                            </div>
                        </li>
                        <li class="list-input-item">
                            <div class="item-left fl">
                                <div class="item-name fl"><span>手机号码</span></div>
                                <div class="item-value fr">

                                    <input id="txt_ctPhone" placeholder="请输入手机号码" type="text" style="width:100%;" />

                                </div>
                            </div>
                        </li>
                        <li class="list-input-item">
                            <div class="item-left fl">
                                <div class="item-name fl"><span>是否学员</span></div>
                                <div class="item-value fr">

                                    <span> <input id="rd_ctIsStudent_1" name="rd_ctIsStudent" class="radio" type="radio" value="1" checked /><label for="rd_ctIsStudent_1">是</label> </span>
                                    <span> <input id="rd_ctIsStudent_0" name="rd_ctIsStudent" class="radio" type="radio" value="0" /><label for="rd_ctIsStudent_0">否</label> </span>
                                </div>
                            </div>
                        </li>
                        <li class="list-input-item">
                            <div class="item-left fl">
                                <div class="item-name fl"><span>校区选择</span></div>
                                <div class="item-value fr">

                                    <select id="sel_ctSchool">
                                        <option value="">请选择</option>
                                        <option value="越秀校">越秀校</option>
                                        <option value="天润校">天润校</option>
                                        <option value="合生广场校">合生广场校</option>
                                        <option value="光大花园校">光大花园校</option>
                                        <option value="嘉仕花园校">嘉仕花园校</option>
                                        <option value="珠江帝景校">珠江帝景校</option>
                                        <option value="颐景华苑校">颐景华苑校</option>
                                        <option value="洛溪校">洛溪校</option>
                                        <option value="喜盈雅境校">喜盈雅境校</option>
                                        <option value="花样年华校">花样年华校</option>
                                        <option value="金沙御苑校">金沙御苑校</option>
                                        <option value="金海岸校">金海岸校</option>
                                        <option value="金沙洲校">金沙洲校</option>
                                        <option value="华发四季校">华发四季校</option>
                                        <option value="白云尚城校">白云尚城校</option>
                                        <option value="增城新塘校">增城新塘校</option>
                                        <option value="增城凤凰城校">增城凤凰城校</option>
                                        <option value="中海金沙湾校">中海金沙湾校</option>
                                        <option value="千灯湖校">千灯湖校</option>
                                        <option value="深圳龙岗校">深圳龙岗校</option>
                                        <option value="深圳宝安校">深圳宝安校</option>
                                    </select>

                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                <div style="text-align:center;">
                    <img id="btn_Pop_Sure" src="~/Content/images/promote20180910/btn_submit.png" class="btn-com" style="display: inline-block;" />
                </div>
            </div>
        </div>
    </div>
</div>



@section scripts{
    <script type="text/javascript">

        var promoteId = "@Model.PromoteId";
        var refereeId = "@(Model.RefereeId==null?Request.QueryString["refereeId"]: Model.RefereeId)";
        var userId = "@(OwnRequest.GetUserInfo().UserId)";
        var isGetCoupon=@(Model.IsGetCoupon==true?"true":"false");

        $(function () {
            accessLog(promoteId, refereeId, window.document.location.href);
            var shareTitle = '全优加周年庆福利，¥1248元优乐享卡';
            var shareDesc = '限量1028张，60校同抢\n免费送！送！送！';
            var shareLink = 'http://qyj.17fanju.com/Promoteb/Coupon?promoteId=' + promoteId + '&refereeId=' + userId;
            var shareImgUrl = 'http://qyj.17fanju.com/Content/images/promote20180910/share_icon.png';
            wx.ready(function () {

                wx.onMenuShareAppMessage({
                    title: shareTitle,
                    desc: shareDesc,
                    link: shareLink,
                    imgUrl: shareImgUrl,
                    trigger: function (res) {
                    },
                    success: function (res) {
                        shareLog(promoteId, "", shareLink, 1);
                    },
                    cancel: function (res) {

                    },
                    fail: function (res) {
                    }
                });

                wx.onMenuShareTimeline({
                    title: shareTitle,
                    link: shareLink,
                    imgUrl: shareImgUrl,
                    trigger: function (res) {
                        shareLog(promoteId, "", shareLink, 2);
                    },
                    success: function (res) {

                    },
                    cancel: function (res) {

                    },
                    fail: function (res) {

                    }
                });

            });

            $("#btn_OpenCoupon").on("click",function () {
                var _this = $(this);
                $.lumos.postJson({
                    url: "/Promote/GetCardList",
                    data: { promoteId: promoteId },
                    success: function (d) {
                        var cards = d.data;
                        var cardList = [];
                        for (var p in cards) {
                            cardList.push({ cardId: cards[p].cardId, code: cards[p].code });
                        }
                        wx.openCard({
                            cardList: cardList,
                            cancel: function (res) {

                            }
                        });
                    }
                });
            });

            $("#modal_Invite").on("click", function (e) {
                $("#modal_Invite").hide();
            });

            $('#btn_GoInvite').on("click",  function () {

                var scrollTop = document.body.scrollTop;//网页被卷去的高
                $("#modal_Invite").css({ top: scrollTop + "px" });
                $("#modal_Invite").show();
                $("#share_container").show();

                $('#modal_Invite').bind("touchmove",
                    function (e) {
                        e.preventDefault();
                    });
                $("#modal_Invite").bind("mousewheel",
                    function (e) {
                        //阻止浏览器默认方法
                        e.preventDefault();
                    });
            });

        });




    </script>
}
